import {
  ActionArguments,
  FetchedSbomDocument,
  Provider
} from '@/src/types/arguments'
import { fetchFromDependencyGraph } from '@/src/providers/dependencyGraph'
import core from '@actions/core'

export async function arbitrate(actionArguments: ActionArguments) {
  const { provider } = actionArguments
  let documentTuple: FetchedSbomDocument | undefined

  if (provider === Provider.dependencyGraph) {
    core.debug('Fetching SBOM from dependency graph...')
    documentTuple = await fetchFromDependencyGraph(actionArguments)
  } else if (provider === Provider.repository) {
    core.debug('Fetching SBOM from repository...')
    documentTuple = undefined
  } else {
    documentTuple = undefined
  }

  return documentTuple
}
